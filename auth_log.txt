  console.log
    [dotenv@17.2.3] injecting env (3) from .env -- tip: ­ƒöÉ prevent committing .env to code: https://dotenvx.com/precommit

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.log
    Starting beforeAll...

      at Object.log (tests/auth.test.js:8:17)

  console.log
    beforeAll finished.

      at Object.log (tests/auth.test.js:11:17)

[0mPOST /api/auth/login [32m200[0m 154.534 ms - 296[0m
[0mPOST /api/auth/login [33m401[0m 80.965 ms - 37[0m
[0mPOST /api/auth/login [33m401[0m 1.692 ms - 37[0m
  console.log
    Starting afterAll...

      at Object.log (tests/auth.test.js:15:17)

  console.log
    afterAll finished.

      at Object.log (tests/auth.test.js:17:17)

node.exe : FAIL 
tests/auth.test.js
At line:1 char:1
+ & "C:\Program Files
\nodejs/node.exe" 
"C:\Program 
Files\nodejs/node_mo 
...
+ ~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~
    + CategoryInfo   
           : NotSpe  
  cified: (FAIL te   
 sts/auth.test.js    
:String) [], Rem    
oteException
    + FullyQualified 
   ErrorId : Native  
  CommandError
 
  ÔùÅ Auth API ÔÇ║ 
POST /api/auth/change
-password ÔÇ║ should 
change password 
successfully

    PrismaClientKnown
RequestError: 
    Invalid `prisma.u
ser.create()` 
invocation in
    C:\Users\User\.ge
mini\antigravity\scra
tch\receipt-system\te
sts\auth.test.js:69:4
4

      66 
beforeAll(async () 
=> {
      67     // 
Create a dedicated 
user for password 
change tests
      68     const 
passwordHash = await 
require('bcryptjs').h
ash(initialPassword, 
10);
    ÔåÆ 69     const 
user = await 
prisma.user.create(
    Unique 
constraint failed on 
the fields: (`email`)

    [0m [90m 67 
|[39m             
[90m// Create a 
dedicated user for 
password change 
tests[39m
     [90m 68 |[39m 
            
[36mconst[39m 
passwordHash 
[33m=[39m 
[36mawait[39m requi
re([32m'bcryptjs'[3
9m)[33m.[39mhash(in
itialPassword[33m,[
39m [35m10[39m)[33
m;[39m
    [31m[1m>[22m[
39m[90m 69 |[39m   
          
[36mconst[39m user 
[33m=[39m 
[36mawait[39m prism
a[33m.[39muser[33m
.[39mcreate({
     [90m    |[39m 
                     
    
[31m[1m^[22m[39m
     [90m 70 |[39m 
                
data[33m:[39m {
     [90m 71 |[39m 
                    
email[33m:[39m 
testEmail[33m,[39m
     [90m 72 |[39m 
                    
name[33m:[39m 
[32m'Change Pass Use
r'[39m[33m,[39m[0
m

      at ei.handleReq
uestError (node_modul
es/@prisma/client/src
/runtime/RequestHandl
er.ts:228:13)
      at ei.handleAnd
LogRequestError (node
_modules/@prisma/clie
nt/src/runtime/Reques
tHandler.ts:174:12)
      at ei.request (
node_modules/@prisma/
client/src/runtime/Re
questHandler.ts:143:1
2)
      at a (node_modu
les/@prisma/client/sr
c/runtime/getPrismaCl
ient.ts:833:24)
      at 
Object.<anonymous> (t
ests/auth.test.js:69:
26)

  ÔùÅ Auth API ÔÇ║ 
POST /api/auth/change
-password ÔÇ║ should 
fail with invalid 
current password

    PrismaClientKnown
RequestError: 
    Invalid `prisma.u
ser.create()` 
invocation in
    C:\Users\User\.ge
mini\antigravity\scra
tch\receipt-system\te
sts\auth.test.js:69:4
4

      66 
beforeAll(async () 
=> {
      67     // 
Create a dedicated 
user for password 
change tests
      68     const 
passwordHash = await 
require('bcryptjs').h
ash(initialPassword, 
10);
    ÔåÆ 69     const 
user = await 
prisma.user.create(
    Unique 
constraint failed on 
the fields: (`email`)

    [0m [90m 67 
|[39m             
[90m// Create a 
dedicated user for 
password change 
tests[39m
     [90m 68 |[39m 
            
[36mconst[39m 
passwordHash 
[33m=[39m 
[36mawait[39m requi
re([32m'bcryptjs'[3
9m)[33m.[39mhash(in
itialPassword[33m,[
39m [35m10[39m)[33
m;[39m
    [31m[1m>[22m[
39m[90m 69 |[39m   
          
[36mconst[39m user 
[33m=[39m 
[36mawait[39m prism
a[33m.[39muser[33m
.[39mcreate({
     [90m    |[39m 
                     
    
[31m[1m^[22m[39m
     [90m 70 |[39m 
                
data[33m:[39m {
     [90m 71 |[39m 
                    
email[33m:[39m 
testEmail[33m,[39m
     [90m 72 |[39m 
                    
name[33m:[39m 
[32m'Change Pass Use
r'[39m[33m,[39m[0
m

      at ei.handleReq
uestError (node_modul
es/@prisma/client/src
/runtime/RequestHandl
er.ts:228:13)
      at ei.handleAnd
LogRequestError (node
_modules/@prisma/clie
nt/src/runtime/Reques
tHandler.ts:174:12)
      at ei.request (
node_modules/@prisma/
client/src/runtime/Re
questHandler.ts:143:1
2)
      at a (node_modu
les/@prisma/client/sr
c/runtime/getPrismaCl
ient.ts:833:24)
      at 
Object.<anonymous> (t
ests/auth.test.js:69:
26)

  ÔùÅ Auth API ÔÇ║ 
POST /api/auth/change
-password ÔÇ║ should 
fail with short new 
password

    PrismaClientKnown
RequestError: 
    Invalid `prisma.u
ser.create()` 
invocation in
    C:\Users\User\.ge
mini\antigravity\scra
tch\receipt-system\te
sts\auth.test.js:69:4
4

      66 
beforeAll(async () 
=> {
      67     // 
Create a dedicated 
user for password 
change tests
      68     const 
passwordHash = await 
require('bcryptjs').h
ash(initialPassword, 
10);
    ÔåÆ 69     const 
user = await 
prisma.user.create(
    Unique 
constraint failed on 
the fields: (`email`)

    [0m [90m 67 
|[39m             
[90m// Create a 
dedicated user for 
password change 
tests[39m
     [90m 68 |[39m 
            
[36mconst[39m 
passwordHash 
[33m=[39m 
[36mawait[39m requi
re([32m'bcryptjs'[3
9m)[33m.[39mhash(in
itialPassword[33m,[
39m [35m10[39m)[33
m;[39m
    [31m[1m>[22m[
39m[90m 69 |[39m   
          
[36mconst[39m user 
[33m=[39m 
[36mawait[39m prism
a[33m.[39muser[33m
.[39mcreate({
     [90m    |[39m 
                     
    
[31m[1m^[22m[39m
     [90m 70 |[39m 
                
data[33m:[39m {
     [90m 71 |[39m 
                    
email[33m:[39m 
testEmail[33m,[39m
     [90m 72 |[39m 
                    
name[33m:[39m 
[32m'Change Pass Use
r'[39m[33m,[39m[0
m

      at ei.handleReq
uestError (node_modul
es/@prisma/client/src
/runtime/RequestHandl
er.ts:228:13)
      at ei.handleAnd
LogRequestError (node
_modules/@prisma/clie
nt/src/runtime/Reques
tHandler.ts:174:12)
      at ei.request (
node_modules/@prisma/
client/src/runtime/Re
questHandler.ts:143:1
2)
      at a (node_modu
les/@prisma/client/sr
c/runtime/getPrismaCl
ient.ts:833:24)
      at 
Object.<anonymous> (t
ests/auth.test.js:69:
26)


  ÔùÅ Test suite 
failed to run

    PrismaClientKnown
RequestError: 
    Invalid `prisma.u
ser.delete()` 
invocation in
    C:\Users\User\.ge
mini\antigravity\scra
tch\receipt-system\te
sts\auth.test.js:97:3
7

      94 });
      95 
      96 
afterAll(async () => 
{
    ÔåÆ 97     await 
prisma.user.delete(
    Foreign key 
constraint violated 
on the constraint: `U
serRole_user_id_fkey`

    [0m [90m  95 
|[39m
     [90m  96 
|[39m         afterA
ll([36masync[39m 
() [33m=>[39m {
    [31m[1m>[22m[
39m[90m  97 |[39m  
           
[36mawait[39m prism
a[33m.[39muser[33m
.[39m[36mdelete[39
m({ where[33m:[39m 
{ email[33m:[39m 
testEmail } 
})[33m;[39m
     [90m     
|[39m             
[31m[1m^[22m[39m
     [90m  98 
|[39m         
})[33m;[39m
     [90m  99 |[39m
     [90m 100 
|[39m         
it([32m'should 
change password succe
ssfully'[39m[33m,[
39m [36masync[39m 
() [33m=>[39m {[0m

      at ei.handleReq
uestError (node_modul
es/@prisma/client/src
/runtime/RequestHandl
er.ts:228:13)
      at ei.handleAnd
LogRequestError (node
_modules/@prisma/clie
nt/src/runtime/Reques
tHandler.ts:174:12)
      at ei.request (
node_modules/@prisma/
client/src/runtime/Re
questHandler.ts:143:1
2)
      at a (node_modu
les/@prisma/client/sr
c/runtime/getPrismaCl
ient.ts:833:24)
      at 
Object.<anonymous> (t
ests/auth.test.js:97:
13)

Test Suites: 1 
failed, 1 total
Tests:       3 
failed, 3 passed, 6 
total
Snapshots:   0 total
Time:        1.752 
s, estimated 3 s
Ran all test suites 
matching 
tests/auth.test.js.
